             pipeline {
               agent any
               environment {
                 //Set the KUBECONFIG environment variable
                 KUBECONFIG = '/Users/Damjan.Gjorgievski/.kube/config' 
               }
               stages {
                 stage('Verify') {
                   steps {
                     //this commands verify that the authentication and configuration are working correctly
                     bat 'kubectl config get-contexts'
                   }
                 }
                 stage('Deploy : final-project-wp-scalefocus.') {
                   steps {
                     script {
                       try {
                         // Check if the namespace exists
                         def namespaceExists = bat(script: 'kubectl get namespace wp', returnStatus: true) == 0
                         if (!namespaceExists) {
                           // Create the namespace
                           bat 'kubectl create namespace wp'
                         }
                         // Deploy the application using Helm
                         bat 'helm install final-project-wp-scalefocus C:/Users/Damjan.Gjorgievski/Documents/final_project_scalefocus/charts/bitnami/wordpress -n wp -f C:/Users/Damjan.Gjorgievski/Documents/final_project_scalefocus/charts/bitnami/wordpress/values.yaml'

                       } catch (Exception e) {
                         // Handle any deployment errors
                         error "Deployment failed: ${e.getMessage()}"
                       }
                     }
                   }
                 }
               }
             }
